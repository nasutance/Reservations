import{Q as C,j as f,f as s,o as i,b as u,a as S,w as o,g as y,t as l,m as c,x as r,u as x,q as _}from"./app-pR54vJex.js";import{f as h}from"./formatDate-D984MnE_.js";import{_ as N}from"./DataTable-dhz1t69T.js";const $=["onUpdate:modelValue"],D={key:1},E=["onUpdate:modelValue"],A={key:1},B=["onUpdate:modelValue"],M={key:1},j=["onUpdate:modelValue"],F={key:1},L=["onUpdate:modelValue"],R={key:1},q={class:"flex gap-2 items-center"},I=["onClick"],Q=["onClick"],T=["onClick"],K={__name:"PriceSection",setup(z){const k=C().props.prices??[],m=f([...k]),v=["Libell√©","Description","Montant","D√©but","Fin","Actions"],b=["type","description","price","start_date","end_date","actions"],a=f(new Set);function d(t){return a.value.has(t)}function V(){const t={id:`new-${Date.now()}`,type:"",description:"",price:0,start_date:"",end_date:"",isNew:!0};m.value.unshift(t),a.value.add(t.id)}function P(t){d(t)?a.value.delete(t):a.value.add(t)}function U(t){const p=t.isNew?"post":"put",e=t.isNew?"/price":`/price/${t.id}`;_[p](e,{type:t.type,description:t.description,price:t.price,start_date:t.start_date,end_date:t.end_date},{onSuccess:()=>{a.value.delete(t.id),_.reload({preserveScroll:!0})}})}function g(t){confirm("Supprimer d√©finitivement ce prix ?")&&_.delete(`/price/${t}`,{preserveScroll:!0,onSuccess:()=>{a.value.delete(t),_.reload({preserveScroll:!0})}})}return(t,p)=>(i(),s("div",null,[p[0]||(p[0]=u("h3",{class:"text-xl font-semibold mb-4"},"Liste des prix",-1)),u("button",{onClick:V},"‚ûï Ajouter un prix"),S(N,{headers:v,fields:b,rows:m.value},{type:o(({row:e})=>[d(e.id)?c((i(),s("input",{key:0,"onUpdate:modelValue":n=>e.type=n,class:"border px-2 py-1 rounded w-full"},null,8,$)),[[r,e.type]]):(i(),s("span",D,l(e.type),1))]),description:o(({row:e})=>[d(e.id)?c((i(),s("input",{key:0,"onUpdate:modelValue":n=>e.description=n,class:"border px-2 py-1 rounded w-full"},null,8,E)),[[r,e.description]]):(i(),s("span",A,l(e.description),1))]),price:o(({row:e})=>[d(e.id)?c((i(),s("input",{key:0,type:"number","onUpdate:modelValue":n=>e.price=n,min:"0",step:"0.01",class:"border px-2 py-1 rounded w-20"},null,8,B)),[[r,e.price]]):(i(),s("span",M,l(e.price)+"‚Ç¨",1))]),start_date:o(({row:e})=>[d(e.id)?c((i(),s("input",{key:0,type:"date","onUpdate:modelValue":n=>e.start_date=n,class:"border px-2 py-1 rounded w-full"},null,8,j)),[[r,e.start_date]]):(i(),s("span",F,l(x(h)(e.start_date,{time:!1})),1))]),end_date:o(({row:e})=>[d(e.id)?c((i(),s("input",{key:0,type:"date","onUpdate:modelValue":n=>e.end_date=n,class:"border px-2 py-1 rounded w-full"},null,8,L)),[[r,e.end_date]]):(i(),s("span",R,l(x(h)(e.end_date,{time:!1})),1))]),actions:o(({row:e})=>[u("div",q,[u("button",{onClick:n=>P(e.id),class:"text-sm text-blue-600"},l(d(e.id)?"Annuler":"‚úèÔ∏è Modifier"),9,I),d(e.id)?(i(),s("button",{key:0,onClick:n=>U(e),class:"text-sm text-green-600"}," üíæ Enregistrer ",8,Q)):y("",!0),d(e.id)&&!e.isNew?(i(),s("button",{key:1,onClick:n=>g(e.id),class:"text-sm text-red-500 ml-2"}," ‚ùå ",8,T)):y("",!0)])]),_:1},8,["rows"])]))}};export{K as default};
