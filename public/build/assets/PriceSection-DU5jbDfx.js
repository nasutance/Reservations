import{Q as P,j as y,f as s,o as n,b as l,a as S,w as a,F as U,g as N,m as c,p as r,t as p,u as h,q as _}from"./app-BMjlmMSH.js";import{f as v}from"./formatDate-D984MnE_.js";import{_ as $}from"./DataTable-B0UdSOJv.js";const D=["onUpdate:modelValue"],E={key:1},F=["onUpdate:modelValue"],A={key:1},B=["onUpdate:modelValue"],M={key:1},j=["onUpdate:modelValue"],L={key:1},R=["onUpdate:modelValue"],q={key:1},I={class:"flex flex-col gap-2 items-start mt-1"},Q=["onClick"],T=["onClick"],z=["onClick"],G=["onClick"],W={__name:"PriceSection",setup(H){const k=P().props.prices??[],m=y([...k]),x=["Libellé","Description","Montant","Début","Fin","Actions"],b=["type","description","price","start_date","end_date","actions"],o=y(new Set);function d(t){return o.value.has(t)}function V(){const t={id:`new-${Date.now()}`,type:"",description:"",price:0,start_date:"",end_date:"",isNew:!0};m.value.unshift(t),o.value.add(t.id)}function f(t){d(t)?o.value.delete(t):o.value.add(t)}function g(t){const u=t.isNew?"post":"put",e=t.isNew?"/price":`/price/${t.id}`;_[u](e,{type:t.type,description:t.description,price:t.price,start_date:t.start_date,end_date:t.end_date},{onSuccess:()=>{o.value.delete(t.id),_.reload({preserveScroll:!0})}})}function C(t){confirm("Supprimer définitivement ce prix ?")&&_.delete(`/price/${t}`,{preserveScroll:!0,onSuccess:()=>{o.value.delete(t),_.reload({preserveScroll:!0})}})}return(t,u)=>(n(),s("div",null,[u[0]||(u[0]=l("h3",{class:"text-xl font-semibold mb-4"},"Liste des prix",-1)),l("button",{onClick:V},"➕ Ajouter un prix"),S($,{headers:x,fields:b,rows:m.value},{type:a(({row:e})=>[d(e.id)?c((n(),s("input",{key:0,"onUpdate:modelValue":i=>e.type=i,class:"border px-2 py-1 rounded w-full"},null,8,D)),[[r,e.type]]):(n(),s("span",E,p(e.type),1))]),description:a(({row:e})=>[d(e.id)?c((n(),s("input",{key:0,"onUpdate:modelValue":i=>e.description=i,class:"border px-2 py-1 rounded w-full"},null,8,F)),[[r,e.description]]):(n(),s("span",A,p(e.description),1))]),price:a(({row:e})=>[d(e.id)?c((n(),s("input",{key:0,type:"number","onUpdate:modelValue":i=>e.price=i,min:"0",step:"0.01",class:"border px-2 py-1 rounded w-20"},null,8,B)),[[r,e.price]]):(n(),s("span",M,p(e.price)+"€",1))]),start_date:a(({row:e})=>[d(e.id)?c((n(),s("input",{key:0,type:"date","onUpdate:modelValue":i=>e.start_date=i,class:"border px-2 py-1 rounded w-full"},null,8,j)),[[r,e.start_date]]):(n(),s("span",L,p(h(v)(e.start_date,{time:!1})),1))]),end_date:a(({row:e})=>[d(e.id)?c((n(),s("input",{key:0,type:"date","onUpdate:modelValue":i=>e.end_date=i,class:"border px-2 py-1 rounded w-full"},null,8,R)),[[r,e.end_date]]):(n(),s("span",q,p(h(v)(e.end_date,{time:!1})),1))]),actions:a(({row:e})=>[l("div",I,[d(e.id)?(n(),s(U,{key:1},[l("button",{class:"text-green-600 text-sm hover:underline",onClick:i=>g(e)}," 💾 Enregistrer ",8,T),l("button",{class:"text-gray-600 text-sm hover:underline",onClick:i=>f(e.id)}," 🔄 Annuler ",8,z),e.isNew?N("",!0):(n(),s("button",{key:0,class:"text-red-600 text-sm hover:underline",onClick:i=>C(e.id)}," 🗑️ Supprimer ",8,G))],64)):(n(),s("button",{key:0,class:"text-blue-600 text-sm hover:underline",onClick:i=>f(e.id)}," ✏️ Modifier ",8,Q))])]),_:1},8,["rows"])]))}};export{W as default};
