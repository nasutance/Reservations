import{Q as y,j as h,k as S,f as s,o as n,b as l,a as U,w as a,F as N,g as $,m as r,p as c,t as p,u as v,q as _}from"./app-C7L2AEoC.js";import{f as k}from"./formatDate-D984MnE_.js";import{_ as D}from"./DataTable-DFNUlY3K.js";const E=["onUpdate:modelValue"],F={key:1},A=["onUpdate:modelValue"],B={key:1},M=["onUpdate:modelValue"],j={key:1},L=["onUpdate:modelValue"],R={key:1},q=["onUpdate:modelValue"],I={key:1},Q={class:"flex flex-col gap-2 items-start mt-1"},T=["onClick"],z=["onClick"],G=["onClick"],H=["onClick"],X={__name:"PriceSection",setup(J){const x=y().props.prices??[],m=h([...x]),o=h(new Set),b=["Libellé","Description","Montant","Début","Fin","Actions"],V=["type","description","price","start_date","end_date","actions"];S(()=>y().props.prices,t=>{m.value=[...t]});function d(t){return o.value.has(t)}function g(){const t={id:`new-${Date.now()}`,type:"",description:"",price:0,start_date:"",end_date:"",isNew:!0};m.value.unshift(t),o.value.add(t.id)}function f(t){d(t)?o.value.delete(t):o.value.add(t)}function C(t){const u=t.isNew?"post":"put",e=t.isNew?"/price":`/price/${t.id}`;_[u](e,{type:t.type,description:t.description,price:t.price,start_date:t.start_date,end_date:t.end_date},{preserveScroll:!0,onSuccess:()=>{o.value.clear(),_.reload({only:["prices"],preserveScroll:!0})}})}function P(t){confirm("Supprimer définitivement ce prix ?")&&_.delete(`/price/${t}`,{preserveScroll:!0,onSuccess:()=>{o.value.clear(),_.reload({only:["prices"],preserveScroll:!0})}})}return(t,u)=>(n(),s("div",null,[u[0]||(u[0]=l("h3",{class:"text-xl font-semibold mb-4"},"Liste des prix",-1)),l("button",{onClick:g},"➕ Ajouter un prix"),U(D,{headers:b,fields:V,rows:m.value},{type:a(({row:e})=>[d(e.id)?r((n(),s("input",{key:0,"onUpdate:modelValue":i=>e.type=i,class:"border px-2 py-1 rounded w-full"},null,8,E)),[[c,e.type]]):(n(),s("span",F,p(e.type),1))]),description:a(({row:e})=>[d(e.id)?r((n(),s("input",{key:0,"onUpdate:modelValue":i=>e.description=i,class:"border px-2 py-1 rounded w-full"},null,8,A)),[[c,e.description]]):(n(),s("span",B,p(e.description),1))]),price:a(({row:e})=>[d(e.id)?r((n(),s("input",{key:0,type:"number","onUpdate:modelValue":i=>e.price=i,min:"0",step:"0.01",class:"border px-2 py-1 rounded w-20"},null,8,M)),[[c,e.price]]):(n(),s("span",j,p(e.price)+"€",1))]),start_date:a(({row:e})=>[d(e.id)?r((n(),s("input",{key:0,type:"date","onUpdate:modelValue":i=>e.start_date=i,class:"border px-2 py-1 rounded w-full"},null,8,L)),[[c,e.start_date]]):(n(),s("span",R,p(v(k)(e.start_date,{time:!1})),1))]),end_date:a(({row:e})=>[d(e.id)?r((n(),s("input",{key:0,type:"date","onUpdate:modelValue":i=>e.end_date=i,class:"border px-2 py-1 rounded w-full"},null,8,q)),[[c,e.end_date]]):(n(),s("span",I,p(v(k)(e.end_date,{time:!1})),1))]),actions:a(({row:e})=>[l("div",Q,[d(e.id)?(n(),s(N,{key:1},[l("button",{class:"text-green-600 text-sm hover:underline",onClick:i=>C(e)},"💾 Enregistrer",8,z),l("button",{class:"text-gray-600 text-sm hover:underline",onClick:i=>f(e.id)},"🔄 Annuler",8,G),e.isNew?$("",!0):(n(),s("button",{key:0,class:"text-red-600 text-sm hover:underline",onClick:i=>P(e.id)},"🗑️ Supprimer",8,H))],64)):(n(),s("button",{key:0,class:"text-blue-600 text-sm hover:underline",onClick:i=>f(e.id)}," ✏️ Modifier ",8,T))])]),_:1},8,["rows"])]))}};export{X as default};
