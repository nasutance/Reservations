import{Q as h,h as $,f as r,o as a,b as i,c as C,w as l,g as f,n as q,t as S,q as R}from"./app-C7L2AEoC.js";import{_ as B}from"./DataTable-DFNUlY3K.js";import{f as D}from"./formatDate-D984MnE_.js";const M={class:"p-6 text-gray-900"},T=["innerHTML"],A={class:"flex gap-3"},w=["onClick"],z=["onClick"],H={key:1,class:"mt-4 text-gray-500"},E={__name:"MemberDashboard",setup(L){const y=h().props.reservations??[],x=h().props.prices??[],c=$(()=>y.map(n=>{var o,d,p,m,v;const e=(n.representations??[]).map(s=>({...s,pivot:{...s.pivot,original_price_id:s.pivot.price_id,original_quantity:s.pivot.quantity}})),t=e.filter(s=>s.pivot.quantity>0).map(s=>{const _=x.find(b=>b.id===s.pivot.price_id);return _?`${s.pivot.quantity} ${_.type}`:`${s.pivot.quantity} -`}).join("<br>");return{id:n.id,user:n.user?`${n.user.firstname} ${n.user.lastname}`:"-",showTitle:((d=(o=e[0])==null?void 0:o.show)==null?void 0:d.title)||"-",schedule:(p=e[0])!=null&&p.schedule?D(e[0].schedule,!0):"-",location:((v=(m=e[0])==null?void 0:m.location)==null?void 0:v.designation)||"-",status:n.status,detail:t,representations:e}})),g=["#","Spectacle","Repr√©sentation","Statut","D√©tail","Actions"],k=["id","showTitle","schedule","status","detail","actions"];function u(n,e){e==="annul√©e"&&!confirm("Confirmer l‚Äôannulation de cette r√©servation ?")||R.visit(`/reservation/${n}`,{method:"patch",data:{status:e},preserveScroll:!0,preserveState:!1})}return(n,e)=>(a(),r("div",null,[e[0]||(e[0]=i("h2",{class:"text-xl font-semibold text-gray-800 leading-tight mb-4"},"Mes r√©servations",-1)),i("div",M,[c.value.length?(a(),C(B,{key:0,headers:g,fields:k,rows:c.value},{status:l(({row:t})=>[i("span",{class:q(["capitalize font-semibold",{"text-yellow-600":t.status==="en attente","text-green-600":t.status==="pay√©e","text-red-600":t.status==="annul√©e"}])},S(t.status),3)]),detail:l(({row:t})=>[i("span",{innerHTML:t.detail},null,8,T)]),actions:l(({row:t})=>[i("div",A,[t.status==="en attente"?(a(),r("button",{key:0,onClick:o=>u(t.id,"pay√©e"),class:"text-sm text-green-600 hover:underline"}," üí≥ Payer ",8,w)):f("",!0),t.status!=="annul√©e"?(a(),r("button",{key:1,onClick:o=>u(t.id,"annul√©e"),class:"text-sm text-red-600 hover:underline"}," ‚ùå Annuler ",8,z)):f("",!0)])]),_:1},8,["rows"])):(a(),r("p",H," Aucune r√©servation pour le moment. "))])]))}};export{E as default};
