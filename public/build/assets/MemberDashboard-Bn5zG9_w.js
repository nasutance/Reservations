import{Q as y,h as q,f as i,o as n,b as l,c as S,w as d,g as f,F as $,l as A,t as c,n as R,q as B}from"./app-CexaMQVR.js";import{_ as D}from"./DataTable-CY3irTDa.js";import{f as F}from"./formatDate-D984MnE_.js";const z={class:"p-6 text-gray-900"},M={key:0},N={key:1},T={class:"flex gap-3"},V=["onClick"],E=["onClick"],L={key:1,class:"mt-4 text-gray-500"},G={__name:"MemberDashboard",setup(P){const x=y().props.reservations??[],g=y().props.prices??[],p=q(()=>x.map(s=>{var o,r,v,_,h;const e=(s.representations??[]).map(a=>({...a,pivot:{...a.pivot,original_price_id:a.pivot.price_id,original_quantity:a.pivot.quantity}})),t=e.filter(a=>a.pivot.quantity>0).map(a=>{const u=g.find(C=>C.id===a.pivot.price_id);return{quantity:a.pivot.quantity,type:(u==null?void 0:u.type)||"-"}});return{id:s.id,user:s.user?`${s.user.firstname} ${s.user.lastname}`:"-",showTitle:((r=(o=e[0])==null?void 0:o.show)==null?void 0:r.title)||"-",schedule:(v=e[0])!=null&&v.schedule?F(e[0].schedule,!0):"-",location:((h=(_=e[0])==null?void 0:_.location)==null?void 0:h.designation)||"-",status:s.status,detail:t,representations:e}})),k=["#","Spectacle","Repr√©sentation","Statut","D√©tail","Actions"],b=["id","showTitle","schedule","status","detail","actions"];function m(s,e){e==="annul√©e"&&!confirm("Confirmer l‚Äôannulation de cette r√©servation ?")||B.visit(`/reservation/${s}`,{method:"patch",data:{status:e},preserveScroll:!0,preserveState:!1})}return(s,e)=>(n(),i("div",null,[e[0]||(e[0]=l("h2",{class:"text-xl font-semibold text-gray-800 leading-tight mb-4"},"Mes r√©servations",-1)),l("div",z,[p.value.length?(n(),S(D,{key:0,headers:k,fields:b,rows:p.value},{status:d(({row:t})=>[l("span",{class:R(["capitalize font-semibold",{"text-yellow-600":t.status==="en attente","text-green-600":t.status==="pay√©e","text-red-600":t.status==="annul√©e"}])},c(t.status),3)]),detail:d(({row:t})=>[Array.isArray(t.detail)?(n(),i("div",M,[(n(!0),i($,null,A(t.detail,(o,r)=>(n(),i("div",{key:r},c(o.quantity)+" "+c(o.type),1))),128))])):(n(),i("div",N,c(t.detail),1))]),actions:d(({row:t})=>[l("div",T,[t.status==="en attente"?(n(),i("button",{key:0,onClick:o=>m(t.id,"pay√©e"),class:"text-sm text-green-600 hover:underline"}," üí≥ Payer ",8,V)):f("",!0),t.status!=="annul√©e"?(n(),i("button",{key:1,onClick:o=>m(t.id,"annul√©e"),class:"text-sm text-red-600 hover:underline"}," ‚ùå Annuler ",8,E)):f("",!0)])]),_:1},8,["rows"])):(n(),i("p",L," Aucune r√©servation pour le moment. "))])]))}};export{G as default};
